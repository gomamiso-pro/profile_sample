<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>47都道府県 — オレンジ代表アイス一覧</title>
<style>
  :root{
    --bg:#fff9f2;
    --card:#ffffff;
    --accent:#ff8c42;
    --muted:#666;
    --shadow: 0 6px 18px rgba(0,0,0,0.08);
    font-family: "Noto Sans JP", "Helvetica Neue", Arial, sans-serif;
  }
  body{ margin:0; background:linear-gradient(180deg,var(--bg),#fff); color:#222; }
  header{ padding:20px; background:linear-gradient(90deg,var(--accent),#ffb074); color:white; box-shadow:0 4px 12px rgba(0,0,0,0.06); }
  header h1{ margin:0;font-size:20px; }
  header p{ margin:6px 0 0; opacity:0.95; font-size:13px; }
  main{ max-width:1100px; margin:24px auto; padding:0 16px 80px;}
  .grid{ display:grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap:16px; }
  .card{ background:var(--card); border-radius:12px; padding:12px; box-shadow:var(--shadow); display:flex; gap:12px; align-items:flex-start; }
  .thumb{ width:120px; height:120px; border-radius:10px; background:linear-gradient(180deg,#fff,#fff); display:flex; justify-content:center; align-items:center; overflow:hidden; border:1px solid #eee; flex:0 0 120px; }
  .thumb img{ width:100%; height:100%; object-fit:cover; display:block; }
  .info{ flex:1; min-width:0; }
  .pref{ font-weight:700; font-size:16px; margin-bottom:6px; display:flex; justify-content:space-between; align-items:center; gap:8px; }
  .pref small{ font-weight:500; font-size:12px; color:var(--muted); }
  .fields{ display:flex; gap:8px; flex-wrap:wrap; }
  .fields input[type="text"]{ flex:1 1 180px; padding:8px 10px; border-radius:8px; border:1px solid #ddd; font-size:14px; }
  .fields input[type="url"]{ flex:1 1 240px; padding:8px 10px; border-radius:8px; border:1px solid #ddd; font-size:13px; }
  .btns{ margin-top:8px; display:flex; gap:8px; }
  button{ background:var(--accent); color:white; border:none; padding:8px 10px; border-radius:8px; cursor:pointer; }
  button.ghost{ background:#f4f4f4; color:#444; border:1px solid #e0e0e0; }
  footer{ max-width:1100px; margin:0 auto 40px; padding:0 16px; color:#666; font-size:13px;}
  .controls{ display:flex; gap:8px; align-items:center; margin:12px 0 18px; flex-wrap:wrap; }
  .notice{ background:#fff3e6; border-left:4px solid var(--accent); padding:10px 12px; border-radius:8px; color:#6a3b00; font-size:13px; }
  @media (max-width:480px){
    .thumb{ width:96px; height:96px; flex:0 0 96px; }
  }
</style>
</head>
<body>
<header>
  <h1>47都道府県 — オレンジ代表アイス一覧（テンプレート）</h1>
  <p>各県の「オレンジ系の代表アイス」を入力して、画像URLを貼るか画像をアップロードすると一覧表示されます。</p>
</header>

<main>
  <div class="notice">使い方: 各行で「品名」を入力、画像はURL貼付 or 「画像を選択」でローカル画像をプレビュー。完了したら下の「HTMLをダウンロード」でページ単体のHTMLとして保存できます。</div>

  <div style="margin:12px 0;" class="controls">
    <button id="fill-sample">サンプルを3件だけ埋める</button>
    <button id="reset" class="ghost">全てリセット</button>
    <button id="download">HTMLをダウンロード</button>
    <span style="margin-left:auto; color:#444; font-size:13px;">47 都道府県のカタログ</span>
  </div>

  <div class="grid" id="list">
    <!-- JavaScript が 47件のカードを生成します -->
  </div>
</main>

<footer>
  <p>テンプレート提供: 自動生成HTML — 好きなレイアウトにカスタマイズしてください。画像は外部URLを直接貼るか、ファイル選択でローカル画像を使えます。</p>
</footer>

<script>
  // 47都道府県（日本語）
  const prefectures = [
    "北海道","青森県","岩手県","宮城県","秋田県","山形県","福島県",
    "茨城県","栃木県","群馬県","埼玉県","千葉県","東京都","神奈川県",
    "新潟県","富山県","石川県","福井県","山梨県","長野県","岐阜県","静岡県","愛知県",
    "三重県","滋賀県","京都府","大阪府","兵庫県","奈良県","和歌山県",
    "鳥取県","島根県","岡山県","広島県","山口県",
    "徳島県","香川県","愛媛県","高知県",
    "福岡県","佐賀県","長崎県","熊本県","大分県","宮崎県","鹿児島県","沖縄県"
  ];

  const listEl = document.getElementById('list');

  // 初期データ（空）を生成する
  const data = prefectures.map(pref => ({
    prefecture: pref,
    product: "",     // 品名
    imageUrl: ""     // 画像URL (または objectURL from file)
  }));

  function createCard(item, idx){
    const card = document.createElement('div');
    card.className = 'card';
    card.dataset.index = idx;

    const thumb = document.createElement('div');
    thumb.className = 'thumb';
    const img = document.createElement('img');
    img.alt = item.prefecture + ' の画像';
    img.src = placeholderDataURI(item.prefecture);
    thumb.appendChild(img);

    const info = document.createElement('div');
    info.className = 'info';

    const pref = document.createElement('div');
    pref.className = 'pref';
    const left = document.createElement('div');
    left.textContent = item.prefecture;
    const right = document.createElement('small');
    right.textContent = 'オレンジ系アイス';
    pref.appendChild(left);
    pref.appendChild(right);

    const fields = document.createElement('div');
    fields.className = 'fields';

    const productInput = document.createElement('input');
    productInput.type = 'text';
    productInput.placeholder = '品名を入力（例: ○○みかんジェラート）';
    productInput.value = item.product || '';
    productInput.addEventListener('input', (e)=> {
      data[idx].product = e.target.value;
    });

    const urlInput = document.createElement('input');
    urlInput.type = 'url';
    urlInput.placeholder = '画像URLを貼る（http...） / そのまま空欄可';
    urlInput.value = item.imageUrl || '';
    urlInput.addEventListener('change', (e)=>{
      const v = e.target.value.trim();
      data[idx].imageUrl = v;
      if(v){
        img.src = v;
      } else {
        img.src = placeholderDataURI(item.prefecture);
      }
    });

    const fileInput = document.createElement('input');
    fileInput.type = 'file';
    fileInput.accept = 'image/*';
    fileInput.style.flex = '0 0 120px';
    fileInput.addEventListener('change', (e)=>{
      const f = e.target.files && e.target.files[0];
      if(!f) return;
      const url = URL.createObjectURL(f);
      data[idx].imageUrl = url;
      urlInput.value = ''; // clear url field
      img.src = url;
    });

    fields.appendChild(productInput);
    fields.appendChild(urlInput);
    fields.appendChild(fileInput);

    const btns = document.createElement('div');
    btns.className = 'btns';
    const clearBtn = document.createElement('button');
    clearBtn.className='ghost';
    clearBtn.textContent = 'リセット';
    clearBtn.addEventListener('click', ()=>{
      productInput.value = '';
      urlInput.value = '';
      fileInput.value = '';
      data[idx].product = '';
      data[idx].imageUrl = '';
      img.src = placeholderDataURI(item.prefecture);
    });

    const copyBtn = document.createElement('button');
    copyBtn.textContent = '行をコピー';
    copyBtn.addEventListener('click', ()=>{
      const text = JSON.stringify(data[idx]);
      navigator.clipboard?.writeText(text).then(()=>{
        copyBtn.textContent = 'コピー済み';
        setTimeout(()=>copyBtn.textContent='行をコピー',900);
      },()=>{
        alert('クリップボードにコピーできませんでした');
      });
    });

    btns.appendChild(clearBtn);
    btns.appendChild(copyBtn);

    info.appendChild(pref);
    info.appendChild(fields);
    info.appendChild(btns);

    card.appendChild(thumb);
    card.appendChild(info);
    return card;
  }

  // プレースホルダー画像（簡単なオレンジ風のSVGデータURI）
  function placeholderDataURI(label){
    const svg = `<svg xmlns='http://www.w3.org/2000/svg' width='600' height='400'><rect width='100%' height='100%' fill='#ffeee0'/><g><circle cx='200' cy='200' r='120' fill='#ffb157'/><text x='360' y='220' font-size='24' font-family='Arial' fill='#7a3b00'>${escapeHtml(label)}</text></g></svg>`;
    return 'data:image/svg+xml;utf8,'+encodeURIComponent(svg);
  }

  function escapeHtml(s){ return (s||'').replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }

  // render all
  function render(){
    listEl.innerHTML = '';
    data.forEach((d,i) => {
      const card = createCard(d,i);
      listEl.appendChild(card);
    });
  }

  render();

  // ボタン操作
  document.getElementById('reset').addEventListener('click', ()=>{
    if(!confirm('全てリセットしてよいですか？')) return;
    data.forEach((d)=>{ d.product=''; d.imageUrl=''; });
    render();
  });

  document.getElementById('fill-sample').addEventListener('click', ()=>{
    // サンプル3件だけ埋める（説明用） — 実在性を保証するものではありません
    const samples = [
      {pref: '愛媛県', product: 'みかんジェラート', image: ''},
      {pref: '和歌山県', product: '南高梅オレンジシャーベット（例）', image: ''},
      {pref: '静岡県', product: '伊豆みかんアイス（例）', image: ''}
    ];
    // find indexes
    samples.forEach(s => {
      const idx = prefectures.indexOf(s.pref);
      if(idx >= 0){
        data[idx].product = s.product;
        data[idx].imageUrl = s.image || '';
      }
    });
    render();
  });

  // HTMLダウンロード（現在の一覧を単体HTMLにしてダウンロード）
  document.getElementById('download').addEventListener('click', ()=>{
    const exportHtml = buildStandaloneHtml();
    const blob = new Blob([exportHtml], {type:'text/html;charset=utf-8'});
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = 'orange-ice-47.html';
    document.body.appendChild(a);
    a.click();
    a.remove();
  });

  function buildStandaloneHtml(){
    // build a simple static page from current data
    const rows = data.map(d => {
      const img = d.imageUrl ? d.imageUrl : placeholderDataURI(d.prefecture);
      const pname = escapeHtml(d.product || '');
      return `<article class="row">
        <div class="thumb"><img src="${img}" alt="${escapeHtml(d.prefecture)}"></div>
        <div class="meta"><h3>${escapeHtml(d.prefecture)}</h3><p class="product">${pname||'<i>（品名未設定）</i>'}</p></div>
      </article>`;
    }).join('\n');

    const html = `<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>47都道府県 — オレンジ代表アイス一覧</title>
<style>
body{font-family:Arial,Helvetica,sans-serif; padding:20px; max-width:900px; margin:auto; background:#fffefb; color:#222;}
h1{color:#ff7a2a;}
.row{display:flex; gap:12px; align-items:center; padding:10px; border-bottom:1px solid #eee;}
.row .thumb{width:120px;height:120px; overflow:hidden;border-radius:10px;border:1px solid #ddd;}
.row .thumb img{width:100%;height:100%;object-fit:cover;display:block;}
.row .meta h3{margin:0 0 6px 0;}
.row .product{margin:0;color:#444;}
@media(max-width:520px){ .row{flex-direction:row; gap:10px;} .row .thumb{width:96px;height:96px;} }
</style>
</head>
<body>
<h1>47都道府県 — オレンジ代表アイス一覧</h1>
<p>（このページはエクスポートされた静的ページです）</p>
<section>
${rows}
</section>
</body>
</html>`;
    return html;
  }

  // 当ページ内で利用するための placeholderDataURI の簡易版（同一文字列は使いまわし）
  function placeholderDataURI(label){
    const svg = `<svg xmlns='http://www.w3.org/2000/svg' width='600' height='400'><rect width='100%' height='100%' fill='#fff7f0'/><g><circle cx='200' cy='200' r='120' fill='#ffb157'/><text x='360' y='220' font-size='24' font-family='Arial' fill='#7a3b00'>${label}</text></g></svg>`;
    return 'data:image/svg+xml;utf8,'+encodeURIComponent(svg);
  }
</script>
</body>
</html>
